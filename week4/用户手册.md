
# 用户手册

## 首部

### attributes

- **项目名称**: Go语言书城项目

- **项目标识**: GOBOOKSTORE-2025-001

- **版本**: V1.0

### 状态与版本信息

- **文件状态**: 草稿

- **文件标识**: SC-GOBOOKSTORE-V1.0-Userbook

- **当前版本**: V1.0

- **作者**:
  
  - **姓名**: 陈泓瑞
  
  - **学号**: 2022011153
  
  - **姓名**: 何祎凡
  
  - **学号**: 2022011145
  
  - **姓名**: 王炳祺
  
  - **学号**: 2022011146

  - **姓名**: 傅宇驰
  
  - **学号**: 2022011127
  
  - **团队**: 404回收站

- **完成日期**: 2025年10月19日

- **版本更新信息**: 首次创建
  

# 一、模块用途

## 1. 首页模块

### 1.1 用途

#### 1.1.1 功能
- 展示图书列表（支持分页浏览）
- 按价格区间筛选图书
- 提供用户登录/注册入口
- 已登录用户显示个人信息及快捷操作（购物车、订单、注销）
- 未登录用户显示登录/注册入口及后台管理入口
- 支持将图书添加到购物车（需登录验证）
- 分页导航（首页、上一页、下一页、末页、页码跳转）

#### 1.1.2 性能

**精度**
- 价格筛选支持精确数值输入
- 分页计算准确，确保总页数和记录数匹配
- 图书库存状态实时显示（有库存显示"加入购物车"，无库存显示补货提示）

**时间特性**
- 首页加载响应时间 < 2秒
- 价格筛选操作响应时间 < 1.5秒
- 分页切换响应时间 < 1秒

**灵活性**
- 适配不同设备屏幕尺寸
- 支持直接跳转至指定页码
- 筛选条件保留在分页导航中，确保分页切换时筛选条件生效

#### 1.1.3 安全保密
- 未登录用户无法添加商品到购物车，自动跳转至登录页
- 后台管理入口权限控制
- 用户信息展示脱敏处理
- 表单提交采用POST方法，避免敏感信息暴露在URL中

### 1.2 使用过程

#### 1.2.1 安装与初始化
1. 确保数据库中存在books表及必要的图书数据
2. 配置首页路由（`/main`）及分页参数
3. 初始化静态资源（CSS、JS、图片）路径

#### 1.2.2 使用流程和操作步骤

**浏览图书列表**
1. 访问首页（`/main`）默认加载第一页图书
2. 系统展示图书封面、名称、作者、价格、销量、库存信息
3. 底部显示分页导航及当前页信息

**价格筛选图书**
1. 在价格筛选框输入最小和最大价格
2. 点击"查询"按钮提交筛选条件
3. 系统展示符合价格区间的图书列表（支持分页）

**分页操作**
1. 点击"上一页"/"下一页"切换相邻页码
2. 点击"首页"/"末页"快速跳转至首尾页
3. 在页码输入框输入指定页码，点击"确定"跳转

**添加图书到购物车**
1. 点击图书卡片中的"加入购物车"按钮
2. 已登录用户：系统添加商品并显示成功提示
3. 未登录用户：自动跳转至登录页面

#### 1.2.3 出错处理和恢复

**常见错误及解决方案**
- 价格输入非数字：默认筛选全部图书，无报错提示
- 页码输入超出范围：自动调整为首页或末页
- 网络异常：页面加载失败时显示刷新按钮
- 图书数据为空：显示"暂无图书"提示信息

## 2. 图书管理页模块

### 2.1 用途

#### 2.1.1 功能
- 展示所有图书的管理列表（名称、价格、作者、销量、库存）
- 支持图书的添加、修改、删除操作
- 分页浏览图书管理列表
- 提供返回商城首页和订单管理的快捷入口

#### 2.1.2 性能

**精度**
- 图书信息展示与数据库数据完全一致
- 分页计算准确，确保管理数据完整
- 操作结果实时反馈（删除/修改成功后立即刷新列表）

**时间特性**
- 图书管理列表加载响应时间 < 2秒
- 图书删除操作响应时间 < 1秒
- 分页切换响应时间 < 1秒

**灵活性**
- 支持批量操作和单条记录操作
- 适配管理端常用屏幕尺寸
- 操作入口清晰，符合管理习惯

#### 2.1.3 安全保密
- 隐含管理员权限控制（仅授权用户可访问）
- 删除操作需二次确认，防止误操作
- 数据提交采用安全方式，避免恶意修改

### 2.2 使用过程

#### 2.2.1 安装与初始化
1. 确保数据库中存在books表及管理所需字段
2. 配置图书管理路由（`/getPageBooks`）
3. 初始化管理页面模板及静态资源

#### 2.2.2 使用流程和操作步骤

**查看图书管理列表**
1. 访问图书管理页（`/getPageBooks`）
2. 系统展示所有图书的管理信息（名称、价格、作者、销量、库存）
3. 底部显示分页导航及记录统计信息

**修改图书信息**
1. 点击目标图书行的"修改"按钮
2. 系统跳转至编辑页面，加载当前图书信息
3. 修改完成后提交，自动返回管理列表并刷新数据

**删除图书**
1. 点击目标图书行的"删除"按钮
2. 系统弹出确认提示框
3. 确认后删除图书，自动刷新列表

**添加新图书**
1. 点击列表底部的"添加图书"按钮
2. 跳转至编辑页面（空表单）
3. 填写图书信息后提交，自动返回管理列表并显示新添加图书

**分页操作**
1. 同首页分页操作，支持页码切换和快速跳转

#### 2.2.3 出错处理和恢复

**常见错误及解决方案**
- 删除不存在的图书：提示"操作失败，图书不存在"
- 提交空表单添加图书：返回编辑页并提示必填项
- 价格/销量/库存输入非数字：提交失败并提示格式错误
- 网络中断：操作失败时保留当前页面状态，允许重试
  
## 3. 购物车模块

### 3.1 用途

#### 3.1.1 功能
- 添加图书到购物车
- 查看购物车商品列表
- 修改购物项数量
- 删除单个购物项
- 清空整个购物车
- 实时计算总金额和总数量

#### 3.1.2 性能

**精度**
- 金额计算精确到小数点后两位
- 数量限制为整数，最小值为1
- 库存校验确保购买数量不超过库存上限

**时间特性**
- 购物车数据加载响应时间 < 2秒
- 数量修改操作响应时间 < 1秒
- 删除操作响应时间 < 1秒

**灵活性**
- 支持多设备购物车数据同步
- 支持批量操作和单个商品操作
- 自动适配不同屏幕尺寸

#### 3.1.3 安全保密
- 用户登录验证机制
- 购物车数据用户隔离
- 敏感操作需要确认提示
- 数据传输加密

### 3.2 使用过程

#### 3.2.1 安装与初始化
1. 确保数据库中存在carts表和cart_items表
2. 初始化用户购物车数据
3. 配置购物车相关路由和权限

#### 3.2.2 使用流程和操作步骤

**添加商品到购物车**
1. 在图书详情页点击"加入购物车"
2. 系统验证用户登录状态
3. 成功添加后显示提示信息

**查看购物车**
1. 点击导航栏"购物车"图标
2. 系统加载购物车数据和所有购物项
3. 显示商品列表、数量、单价和小计

**修改商品数量**
1. 点击购物项数量的"+"或"-"按钮
2. 或在输入框中直接输入数量
3. 系统实时校验库存并更新金额

**删除购物项**
1. 点击购物项右侧"删除"按钮
2. 确认删除操作
3. 系统移除商品并更新总金额

**清空购物车**
1. 点击"清空购物车"按钮
2. 确认清空操作
3. 系统删除所有购物项

#### 3.2.3 出错处理和恢复

**常见错误及解决方案**
- 网络超时：显示重试按钮，用户可手动刷新
- 库存不足：自动调整数量，提示用户
- 数据异常：清除本地缓存，重新加载
- 权限错误：跳转到登录页面

## 4. 订单管理模块

### 4.1 用途

#### 4.1.1 功能
- 创建新订单
- 查看订单列表
- 订单状态管理
- 订单发货处理
- 订单详情查看
- 订单状态筛选和分页

#### 4.1.2 性能

**精度**
- 订单金额精确到分
- 时间记录精确到秒
- 状态变更记录完整

**时间特性**
- 订单列表加载时间 < 3秒
- 状态更新操作 < 2秒
- 分页切换响应 < 1秒

**灵活性**
- 支持多种订单状态筛选
- 可配置每页显示数量
- 支持批量发货操作

#### 4.1.3 安全保密
- 管理员权限验证
- 敏感操作日志记录
- 订单数据访问控制
- 用户隐私信息保护

### 4.2 使用过程

#### 4.2.1 安装与初始化
1. 创建orders订单表
2. 初始化管理员账户和权限
3. 配置订单状态枚举值

#### 4.2.2 使用流程和操作步骤

**管理员登录**
1. 访问管理员订单管理页面
2. 系统验证管理员权限
3. 权限通过后进入管理界面

**查看订单列表**
1. 系统默认加载所有订单
2. 支持按状态筛选订单
3. 分页显示订单信息

**订单发货**
1. 点击"待发货"订单的"发货"按钮
2. 填写物流公司和运单号
3. 确认发货，更新订单状态

**查看订单详情**
1. 点击订单的"查看详情"按钮
2. 系统显示完整订单信息
3. 包含商品明细、收货信息等

**订单状态筛选**
1. 点击顶部状态筛选栏
2. 选择目标订单状态
3. 系统刷新对应订单列表

#### 4.2.3 出错处理和恢复

**常见错误及解决方案**
- 权限不足：重新登录管理员账户
- 订单不存在：刷新列表或检查订单ID
- 状态冲突：刷新订单数据
- 网络异常：检查连接后重试操作

## 5. 个人订单界面

### 5.1 用途

#### 5.1.1 功能
**订单列表展示模块**  
采用动态数据绑定技术实时渲染订单信息，确保界面与数据源完全同步

每个订单卡片展示完整业务信息：
- 系统生成的唯一订单编号（格式：年月日+序列号）
- 精确到秒的创建时间戳
- 人民币符号前缀的格式化金额

**状态标识系统**  
建立颜色编码体系：
- 浅灰色（#f0f0f0）表示未发货
- 天蓝色（#1890ff）表示已发货
- 嫩绿色（#52c41a）表示已完成

**状态交互系统**  
实现完整的状态流转机制：
- 待处理状态显示"等待发货"文字提示，配合浅灰色背景
- 进行中状态提供"确认收货"操作按钮，采用主色调设计
- 已完成状态展示"交易完成"荣誉徽章，配合浅绿色背景

**导航与路由系统**  
用户信息区域清晰展示当前登录用户的身份标识和特权等级（普通用户/VIP用户/管理员）
功能导航提供完整的页面跳转路径：
- 注销功能彻底清除本地会话存储和缓存，确保账户安全
- 返回商城功能保留用户浏览历史和操作上下文

#### 5.1.2 性能优化策略
**数据精度保障**
- 后端采用Decimal数据类型进行金额计算，避免浮点数精度误差
- 建立数据同步校验机制，确保多用户并发操作场景下的数据一致性
- 实施分级缓存策略：静态资源（CSS、JS、图片）设置长期缓存（30天），动态数据设置短期缓存（5分钟）
- 定期执行数据一致性检查，自动修复异常数据

**响应时间优化**
- 数据库层面为UserID、CreateTime、State等常用查询字段建立复合索引
- 实施分页加载机制，当订单数量超过阈值（20条）时自动启用分页，每页显示10条记录

**设备兼容性**
- 基于Bootstrap栅格系统实现全响应式布局：桌面端（≥1200px）采用4列布局，平板端（768px-1199px）采用2列布局，移动端（<768px）采用单列布局
- 移动端触控交互专门优化：操作按钮最小触摸尺寸44×44px，支持滑动手势操作

#### 5.1.3 安全防护体系
**访问控制层**
- 实施严格的会话验证机制，每个接口请求前验证JWT令牌有效性
- 设置合理的会话超时时间（30分钟），平衡安全性和用户体验

**数据传输安全**
- 全站强制启用HTTPS协议，使用TLS 1.3加密传输所有数据
- 敏感信息（订单号、金额）展示时进行部分掩码处理（如：20231201****3489）

### 5.2 使用过程

#### 5.2.1 系统部署要求
**后端环境配置**
- 数据库表结构设计支持业务扩展，包含订单核心字段：OrderID（主键）、UserID（索引）、CreateTime（索引）、TotalCount、TotalAmount、State、收货信息等
- 建立复合索引（UserID+CreateTime）优化查询性能，支持大数据量下的快速响应
- 字段定义精确反映业务含义，数据类型合理平衡存储效率和处理需求

**路由配置规范**
- 采用路由分组管理，将订单相关功能集中到/order路由组
- 统一认证中间件处理身份验证逻辑，确保安全控制的一致性
- 请求处理流程标准化：参数验证→业务处理→结果返回→日志记录

#### 5.2.2 用户操作流程
**订单列表访问流程**
1. 用户点击导航栏"我的订单"入口
2. 前端检查本地token有效性，无效则跳转登录页
3. 携带token发起GET请求到/getMyOrder接口
4. 后端验证token并查询用户订单数据
5. 数据返回后前端渲染订单列表组件
6. 监听滚动事件，接近底部时自动加载下一页

**确认收货操作流程**
1. 用户在已发货订单行点击"确认收货"按钮
2. 弹出确认对话框："请确认已收到商品且无质量问题"
3. 用户确认后，前端发送POST请求到/takeOrder接口
4. 后端验证订单状态和用户权限，更新状态为已完成
5. 前端接收响应后，局部更新订单状态显示
6. 显示操作成功提示，3秒后自动消失

**订单详情跳转流程**
1. 用户点击订单行的"查看详情"链接
2. 前端构造URL：/getOrderInfo?orderId=订单号
3. 在新标签页打开详情页面，保留原页面上下文
4. 详情页面初始化时解析URL参数，加载订单明细数据
5. 支持浏览器前进后退导航，保持用户体验连续性

#### 5.2.3 异常处理机制
**网络异常处理**
- 设置请求超时时间（15秒），超时后显示"网络连接超时"提示
- 监听online/offline事件，网络恢复后自动重试失败请求
- 数据加载期间显示骨架屏动画，减轻用户等待焦虑
- 提供手动刷新按钮，支持用户主动重试

**身份验证异常**
- Token过期时自动跳转登录页，并携带returnUrl参数
- 权限不足时显示"无权访问"提示，3秒后跳转首页
- 检测到多设备登录时，强制下线并发送通知邮件
- 支持扫码登录和短信验证等备用认证方式

## 6. 订单详情界面

### 6.1 用途

#### 6.1.1 功能深度解析
**商品明细展示系统**  
采用响应式表格展示完整商品信息：
- 商品缩略图（80×80px）
- 商品名称（支持tooltip显示全名）
- 作者信息（次要信息灰色显示）
- 单价（右对齐保留两位小数）
- 购买数量（居中加粗显示）
- 小计金额（强调显示）


**多层次导航体系**
- 面包屑导航显示完整路径：首页 > 我的订单 > 订单详情（订单号）
- 快捷操作栏固定顶部，包含：图书管理（管理员权限）、订单管理（返回列表）、返回商城（回首页）
**订单信息汇总**
- 头部信息区展示订单元数据：订单号、状态、创建时间、支付方式、物流单号
- 收货信息区完整展示配送信息：收货人、联系电话、详细地址、预计送达时间
- 金额汇总区清晰列示费用构成：商品总额、运费、优惠券折扣、实付金额
- 每个信息区块支持点击编辑（有权限时），实现快速信息修改

#### 6.1.2 性能极致优化
**数据精确性保障**
- 实施双重金额验证：前端实时计算校验，后端严格逻辑验证
- 计算过程单元测试覆盖率100%，确保各种边界条件下的正确性
- 建立数据变更审计日志，记录关键数据的每次修改
- 验证流程覆盖所有异常场景：除零、溢出、空值、格式错误等

**加载性能优化**
- 数据库查询优化：为OrderID建立唯一索引，使用JOIN查询减少数据库往返
- 实施查询字段选择性加载，避免SELECT * 查询
- 前端资源优化：图片使用WebP格式，CSS/JS文件压缩合并
- 关键CSS内联，避免渲染阻塞，首屏加载时间控制在1.5秒内

**扩展性设计**
- 采用插件化架构，商品信息列支持动态注册和排序
- 展示字段配置化管理，支持通过配置文件调整显示内容
- 主题系统支持多套UI皮肤，满足不同场景的视觉需求
- 扩展机制确保向前兼容，新功能不影响现有业务

#### 6.1.3 全方位安全防护
**细粒度权限控制**
- 数据级权限：所有查询自动添加UserID条件，确保数据隔离
- 操作级权限：基于用户角色控制功能按钮的显示和可用状态

**安全审计追踪**
- 操作日志记录完整的用户访问轨迹：IP、时间、操作、结果
- 数据变更日志跟踪订单状态的每次变化，支持操作回溯

### 6.2 使用过程

#### 6.2.1 环境配置详述
**数据库架构设计**
- 订单明细表包含完整业务字段：OrderItemID、OrderID、BookID、Title、Author、Price、Count、Amount、ImgPath等
- 建立外键约束确保数据一致性，ON DELETE CASCADE自动清理关联数据
- 索引策略：OrderID索引用于关联查询，BookID索引用于商品分析
- 字段类型优化：金额使用DECIMAL(10,2)，字符串长度合理设置

**服务端配置优化**
- 路由处理包含严格参数验证：订单号格式、长度、有效性检查
- 输入数据 sanitization，防止XSS和注入攻击

#### 6.2.2 用户体验流程
**页面加载序列**
1. 解析URL参数，验证orderId格式和权限
2. 显示页面骨架屏：头部导航、表格标题、5行商品占位
3. 并发请求订单基本信息和商品明细数据
4. 按优先级渲染：文本内容→商品图片→统计图表
5. 图片懒加载，优先加载可视区域内容
6. 加载完成隐藏骨架屏，显示完整内容

**交互功能细节**
- 图片查看支持灯箱模式：缩放、旋转、全屏、键盘导航
- 数据导出功能：支持PDF、Excel格式，包含完整订单信息

**导航体验优化**
- 智能返回逻辑：根据访问来源决定返回目标（列表页或商城）
- 深度链接支持直接访问特定订单，便于分享和收藏

#### 6.2.3 容错与降级方案
**多级降级策略**
- 完全降级：核心服务不可用时显示静态错误页面，提供基本功能
- 部分降级：图片服务异常时显示占位图，保证主要功能可用
- 数据降级：实时数据获取失败时显示缓存数据，标注数据时效性
- 降级策略根据监控指标自动触发，最大化系统可用性

**错误分类处理**
- 网络错误：显示离线提示，检测到网络恢复时自动重试
- 数据错误：尝试数据修复，无法修复时提示用户联系客服
- 权限错误：清晰说明权限要求，提供权限申请指引
- 错误信息分级显示：用户看到友好提示，技术人员看到详细日志

# 二、运行环境

### 2.1 硬件设备
- 服务器：2核CPU，4GB内存以上
- 存储空间：50GB以上可用空间
- 网络：100Mbps以上带宽

### 2.2 支持软件
- 操作系统：Linux/Windows Server
- 数据库：MySQL 5.7+
- Web服务器：Nginx/Apache
- 编程语言：Go 1.16+
- 依赖库：标准数据库驱动

### 2.3 数据结构

#### 核心数据表

**用户表 (users)**
- `ID`-用户标识 | `Username`-用户名 | `Password`-密码 | `Phone`-电话 | `Address`-地址

**图书表 (books)**
- `ID`-图书标识 | `Title`-书名 | `Author`-作者 | `Price`-价格 | `Stock`-库存 | `Sales`-销量

**购物车表 (carts)**
- `ID`-购物车ID | `UserID`-用户ID | `TotalCount`-总数量 | `TotalAmount`-总金额

**购物项表 (cart_items)**
- `ID`-购物项ID | `CartID`-购物车ID | `BookID`-图书ID | `Count`-数量 | `SubAmount`-小计

**订单表 (orders)**
- `ID`-订单ID | `OrderNo`-订单号 | `UserID`-用户ID | `TotalAmount`-总金额 | `Status`-状态

**订单项表 (order_items)**
- `ID`-订单项ID | `OrderID`-订单ID | `BookID`-图书ID | `Count`-数量 | `SubAmount`-小计

**会话表 (sessions)**
- `ID`-会话ID | `UserID`-用户ID | `ExpireTime`-过期时间

#### 数据关系
- 用户↔购物车(1:1) ↔ 购物项(1:N)
- 用户↔订单(1:N) ↔ 订单项(1:N)
- 图书↔购物项(1:N) ↔ 订单项(1:N)
