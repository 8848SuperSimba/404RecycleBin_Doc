# 测试报告

## 首部

### attributes

- **项目名称**: Go语言书城项目

- **项目标识**: GOBOOKSTORE-2025-001

- **版本**: V1.0
  
  ### 状态与版本信息

- **文件状态**：正式报告

- **文件标识**： SC-GOBOOKSTORE-TEST-V1.0-OFFICIAL

- **当前版本**：V1.0

- **作者**：
  
  - **姓名**：李泽雨
  
  - **学号**：2019011468
  
  - **姓名**：张恩浦
  
  - **学号**：2022011149
  
  - **姓名**：聂子博 
  
  - **学号**：2022011098
  
  - **团队**：404回收站

- **完成日期**：2025年10月26日

- **版本更新信息**：首次创建，涵盖DAO层与Controller层单元测试全量数据，无历史版本迭代记录
  
  ### 引言

- **使用人员**：项目管理人员、开发团队、测试团队、运维团队、甲方需求对接人员

- **角色与职责**：
  
  - **项目管理人员**：统筹测试进度与整体项目节奏匹配度，协调测试资源（如测试环境、人力），审核测试报告结论，基于测试结果决策项目迭代方向。
  
  - **开发团队**：依据测试报告中的缺陷详情（如DAO层购物车清空失败、Controller层并发测试跳过原因）定位代码问题，完成缺陷修复后配合回归测试，确保功能逻辑符合需求。
  
  - **测试团队**：执行DAO层与Controller层测试用例设计、执行与结果记录，分析测试数据（如语句覆盖率、失败用例占比），输出缺陷报告，跟进修复结果并验证，补充遗漏测试场景。
  
  - **运维团队**：搭建与维护测试所需硬件/软件环境（如MySQL数据库配置、Go语言环境部署），保障测试过程中环境稳定性，协助排查因环境问题导致的测试异常（如数据库连接失败）。
  
  - **甲方需求对接人员**：查阅测试报告了解核心功能（图书、购物车、订单、用户模块）的测试覆盖情况与功能达标度，确认需求是否通过测试验证，提出补充测试或需求调整建议。
  
  - **协同机制**：测试团队定期向项目管理人员同步测试进度，发现缺陷后第一时间同步至开发团队；开发团队修复后反馈测试团队进行回归；运维团队提供环境支持并响应测试中的环境问题；甲方基于测试报告阶段性确认需求落地情况，形成“测试-反馈-修复-验证”的闭环协作。

- **编写目的**：本报告系统梳理Go语言书城项目DAO层与Controller层单元测试的全过程，包括测试范围、环境配置、执行结果、缺陷统计等核心信息。一方面，明确暴露测试中发现的功能缺陷（如购物车清空失败、并发添加购物项外键约束错误）与测试局限性（如Controller层部分并发测试跳过），为开发团队提供精准的修复依据；另一方面，向所有干系人客观呈现当前系统功能的稳定性与完整性，为项目是否进入下一测试阶段（集成测试、系统测试）、是否具备上线基础提供数据支撑，最终保障项目交付质量符合需求预期。

- **背景**：
  
  - 随着线上购书模式的普及，用户对在线书城的功能完整性（如图书查询、购物车管理、订单跟踪）、操作流畅性及数据安全性提出更高要求，Go语言因高性能、高并发特性成为该书城项目后端开发的核心技术选型。
  - 项目当前已完成DAO层（数据访问）与Controller层（业务控制）核心代码开发，需通过单元测试验证两层功能逻辑的正确性、异常处理能力及并发场景稳定性，为后续前端集成与系统整体联调奠定基础，避免底层功能缺陷向上传递导致更大范围的问题。
+ **定义与缩写**：
  
  - **业务术语**：
  - **DAO层**：数据访问对象层，负责项目与数据库的交互，实现图书、购物车、订单、用户等数据的增删改查操作，是项目数据处理的核心底层模块。
  - **Controller层**：控制器层，承接前端请求，调用DAO层接口处理业务逻辑（如图书筛选、订单创建），并向前端返回处理结果，是连接前端与后端数据的中间层。
  - **外键约束**：数据库中用于关联两张表的规则（如购物车表的book_id关联图书表的id），确保关联数据的一致性，避免无效数据插入（如添加不存在图书ID的购物项）。
  - **技术术语**：
  - **单元测试**：针对项目最小功能单元（如DAO层的图书添加函数、Controller层的购物车更新接口）设计测试用例，验证单个单元的逻辑正确性，本次测试主要覆盖DAO层与Controller层单元。
  - **语句覆盖率**：测试用例执行到的代码语句占总语句的比例，本次DAO层测试语句覆盖率为88.7%，反映测试对DAO层代码的覆盖程度。
  - **并发测试**：模拟多用户同时操作同一功能（如并发添加图书、并发更新购物车），验证系统在高并发场景下的数据一致性与稳定性，避免出现数据错乱或服务崩溃问题。
  - **空结果集异常（sql: no rows in result set）**：数据库查询时未找到符合条件的数据导致的异常（如查询已清空的购物车），本次测试中部分用例（如购物车清空后查询）出现该异常，需确认是正常业务场景还是代码逻辑问题。
  - **外键约束错误（Error 1452）**：插入或更新数据时违反外键关联规则导致的错误（如向购物车添加不存在的图书ID），反映系统对无效数据的拦截能力是否完善。
  - **解释**：无

## 测试概要

##### 一、测试用例设计原则

本次测试用例设计围绕 “功能完整性、场景全面性、风险针对性” 三大核心原则，结合项目 DAO 层（数据交互）与 Controller 层（业务控制）的技术特性及业务场景，确保用例覆盖无死角、逻辑无冗余：

1. **功能全覆盖原则**：针对每个业务模块的核心功能（如图书 CRUD、购物车操作、订单流程、用户登录），设计 “正向验证 + 反向校验” 用例，确保基础功能与异常处理均被覆盖；

2. **场景贴近业务原则**：模拟真实用户操作流程（如 “浏览图书→加入购物车→创建订单→确认收货”），设计端到端链路用例，验证跨模块业务联动正确性；

3. **风险优先原则**：针对高风险场景（如并发操作、数据一致性、权限校验），优先设计高频次、高复杂度用例（如多协程并发添加购物项、重复用户名注册），提前暴露潜在隐患；

4. **数据分类原则**：将输入数据划分为 “有效等价类”（如合法图书信息、合规用户数据）与 “无效等价类”（如负价格、空标题、重复用户名），每类选取代表性数据设计用例，减少冗余。

## 二、DAO 层测试用例设计

DAO 层聚焦 “数据交互正确性”，用例设计以 “数据库操作结果” 为核心验证点，覆盖图书、购物车、订单、用户四大模块，具体设计如下：

### （一）图书模块（TestBookOperations/TestBookDataValidation/TestBookConcurrentOperations）

| 用例类别   | 用例场景         | 输入数据                                         | 预期结果                         | 设计目的                          |
| ------ | ------------ | -------------------------------------------- | ---------------------------- | ----------------------------- |
| 基础功能验证 | 测试添加图书       | 图书信息：标题 “Go 语言实战”、作者 “张三”、价格 39.9 元、库存 100 本 | 数据库 books 表新增一条记录，返回添加成功标识   | 验证图书插入逻辑正确性                   |
| 基础功能验证 | 测试根据 ID 查询图书 | 查询 ID=1001 的图书                               | 返回 ID=1001 的图书完整信息（与添加时一致）   | 验证单条数据查询准确性                   |
| 基础功能验证 | 测试分页功能       | 分页参数：页码 1、每页条数 10                            | 返回第 1 页数据，最多 10 条记录，总数与数据库匹配 | 验证分页查询逻辑（limit/offset 计算）正确性  |
| 基础功能验证 | 测试价格筛选       | 筛选条件：价格≥20 元且≤50 元                           | 返回所有价格在 20-50 元区间的图书，无超范围数据  | 验证条件查询（where price between）逻辑 |
| 数据验证   | 零价格图书        | 图书信息：价格 0 元，其他字段合法                           | 拦截添加操作，返回 “价格不能为零” 错误        | 验证数据合法性校验规则                   |
| 数据验证   | 负价格图书        | 图书信息：价格 - 10 元，其他字段合法                        | 拦截添加操作，返回 “价格不能为负数” 错误       | 验证异常价格拦截逻辑                    |
| 数据验证   | 空标题图书        | 图书信息：标题为空字符串，其他字段合法                          | 拦截添加操作，返回 “标题不能为空” 错误        | 验证必填字段校验规则                    |
| 并发场景   | 测试并发添加图书     | 启动 5 个协程，每个协程添加 1 本不同图书                      | 数据库新增 5 条记录，无重复 ID、无数据丢失     | 验证高并发下数据插入一致性                 |
| 并发场景   | 测试并发查询图书     | 启动 10 个协程，同时查询价格 20-50 元图书                   | 所有协程返回相同结果，与数据库实际数据一致        | 验证并发查询时数据读取稳定性                |

### （二）购物车模块（TestCartOperations/TestCartDataValidation/TestCartConcurrentOperations）

| 用例类别   | 用例场景       | 输入数据                                          | 预期结果                                     | 设计目的          |
| ------ | ---------- | --------------------------------------------- | ---------------------------------------- | ------------- |
| 基础功能验证 | 测试添加商品到购物车 | 用户 ID=2025，图书 ID=1001，数量 2 本                  | cart_items 表新增记录，book_id=1001、quantity=2 | 验证购物项插入逻辑     |
| 基础功能验证 | 测试重复添加同一商品 | 同一用户 ID=2025，再次添加图书 ID=1001，数量 3 本            | 原购物项 quantity 更新为 5（2+3），无新增记录           | 验证重复添加时数量叠加逻辑 |
| 基础功能验证 | 测试清空购物车    | 用户 ID=2025，执行清空操作                             | cart_items 表中该用户的所有购物项被删除                | 验证购物车数据删除完整性  |
| 基础功能验证 | 测试购物车总价计算  | 购物项：图书 1（价格 39.9 元，数量 2）、图书 2（价格 59.9 元，数量 1） | 总价 = 39.9×2 +59.9×1=139.7 元              | 验证价格计算逻辑正确性   |
| 数据验证   | 零数量购物项     | 用户 ID=2025，图书 ID=1001，数量 0 本                  | 拦截添加操作，返回 “数量不能为零” 错误                    | 验证购物项数量合法性    |
| 数据验证   | 负数量购物项     | 用户 ID=2025，图书 ID=1001，数量 - 1 本                | 拦截添加操作，返回 “数量不能为负数” 错误                   | 验证异常数量拦截逻辑    |
| 并发场景   | 测试并发添加购物项  | 启动 8 个协程，同一用户添加不同图书（ID=1001-1008）             | cart_items 表新增 8 条记录，无缺失、无重复             | 验证并发添加时数据一致性  |
| 并发场景   | 测试并发更新购物车  | 启动 5 个协程，同一用户更新图书 1001 的数量（每次 + 1）            | 最终 quantity = 初始值 + 5，无计算错误              | 验证并发更新时数据原子性  |

### （三）订单模块（TestOrderFlow/TestOrderDataValidation/TestOrderConcurrentOperations）

| 用例类别   | 用例场景     | 输入数据                                | 预期结果                                              | 设计目的         |
| ------ | -------- | ----------------------------------- | ------------------------------------------------- | ------------ |
| 业务流程验证 | 测试创建订单   | 用户 ID=2025，购物车含 2 本图书（ID=1001、1002） | 1. orders 表新增订单记录；2. 对应图书库存扣减；3. 购物车清空            | 验证订单创建全链路逻辑  |
| 业务流程验证 | 测试订单状态更新 | 订单 ID=5001，更新状态为 “已发货”              | orders 表中该订单 status 字段变为 “已发货”，更新时间同步             | 验证订单状态修改逻辑   |
| 业务流程验证 | 测试库存扣减   | 订单 ID=5001（含图书 1001，数量 2），确认收货      | books 表中图书 1001 的 stock = 原库存 - 2，sales = 原销量 + 2 | 验证库存与销量联动逻辑  |
| 数据验证   | 零金额订单    | 购物车无商品，创建订单                         | 拦截订单创建，返回 “订单金额不能为零” 错误                           | 验证异常订单拦截规则   |
| 数据验证   | 负金额订单    | 购物项含负价格图书（价格 - 10 元），创建订单           | 拦截订单创建，返回 “订单金额不能为负数” 错误                          | 验证订单金额合法性校验  |
| 并发场景   | 测试并发创建订单 | 启动 6 个协程，不同用户创建订单（均含图书 1001）        | 1. 所有订单创建成功；2. 图书 1001 库存 = 原库存 - 总订单数量；3. 无超卖    | 验证并发订单下库存一致性 |

### （四）用户模块（TestSaveUser/TestCheckUserNameAndPassword/TestLoginFlow）

| 用例类别       | 用例场景            | 输入数据                                                   | 预期结果                   | 设计目的              |
| ---------- | --------------- | ------------------------------------------------------ | ---------------------- | ----------------- |
| 注册验证       | 测试正常注册          | 用户信息：用户名 “testuser123”、密码 “123456a!”、邮箱 “test@xxx.com” | users 表新增记录，返回用户 ID    | 验证正常注册逻辑          |
| 注册验证       | 测试用户名重复         | 用户名 “testuser123”（已存在），其他信息合法                          | 拦截注册，返回 “用户名已存在” 错误    | 验证用户名唯一性约束        |
| 注册验证       | 测试空值处理          | 用户名空字符串，其他信息合法                                         | 拦截注册，返回 “用户名不能为空” 错误   | 验证必填字段校验          |
| 登录验证       | 测试正确用户名密码       | 用户名 “testuser123”、密码 “123456a!”                        | 登录成功，创建 Session，返回用户信息 | 验证正常登录逻辑          |
| 登录验证       | 测试错误密码          | 用户名 “testuser123”、密码 “wrongpwd”                        | 登录失败，返回 “密码错误” 提示      | 验证登录密码校验          |
| 登录验证       | 测试空用户名登录        | 用户名空字符串，密码 “123456a!”                                  | 拦截登录，返回 “用户名不能为空” 错误   | 验证登录参数合法性         |
| Session 管理 | 测试 Session 过期处理 | Session 创建后，模拟过期（设置过期时间 1 秒）                           | 过期后访问需登录接口，跳转登录页       | 验证 Session 生命周期管理 |

## 三、Controller 层测试用例设计

Controller 层聚焦 “前端请求处理正确性”，用例设计以 “HTTP 请求参数解析、业务逻辑转发、响应结果返回” 为核心验证点，覆盖图书、购物车、订单、用户四大控制器，具体设计如下：

### （一）图书控制器（TestBookControllerOperations/TestBookControllerDataValidation/TestBookControllerEdgeCases）

| 用例类别   | 用例场景                     | 输入请求                                              | 预期结果                                                       | 设计目的                                 |
| ------ | ------------------------ | ------------------------------------------------- | ---------------------------------------------------------- | ------------------------------------ |
| 接口功能验证 | 测试获取分页图书                 | HTTP GET 请求，参数：page=1&size=10                     | 1. 响应状态码 200；2. 返回第 1 页图书列表（10 条）；3. 包含总页数、总条数             | 验证分页接口参数解析与数据返回                      |
| 接口功能验证 | 测试获取带价格筛选的图书             | HTTP GET 请求，参数：minPrice=20&maxPrice=50            | 1. 响应状态码 200；2. 返回价格 20-50 元的图书，无超范围数据                     | 验证筛选条件接口逻辑                           |
| 接口功能验证 | 测试删除图书                   | HTTP POST 请求，参数：bookId=1001                       | 1. 响应状态码 200；2. 返回 “删除成功” 提示；3. 数据库 books 表中 ID=1001 记录被删除 | 验证图书删除接口与 DAO 层联动                    |
| 数据验证   | 测试空标题图书提交                | HTTP POST 请求，表单数据：title=""、author=“李四”、price=49.9 | 1. 响应状态码 400；2. 返回 “标题不能为空” 提示；3. 数据库无新增记录                 | 验证 Controller 层数据校验（拦截非法数据传递至 DAO 层） |
| 边缘场景   | 测试无效页码参数                 | HTTP GET 请求，参数：page=0&size=10                     | 1. 响应状态码 400；2. 返回 “页码不能小于 1” 提示；3. 不执行数据库查询               | 验证异常参数容错处理                           |
| 边缘场景   | 测试无效图书 ID 删除             | HTTP POST 请求，参数：bookId=9999（不存在）                  | 1. 响应状态码 404；2. 返回 “图书不存在” 提示；3. 数据库无删除操作                  | 验证无效 ID 处理逻辑                         |
| 模板功能   | 测试 parseTemplateFiles 函数 | 调用函数解析不存在的模板：“nonexistent.html”                   | 1. 捕获 panic 异常；2. 返回 “模板文件不存在” 错误                          | 验证模板解析异常处理                           |

### （二）购物车控制器（TestCartControllerOperations/TestCartControllerDataValidation/TestCartControllerEdgeCases）

| 用例类别   | 用例场景         | 输入请求                                                    | 预期结果                                                  | 设计目的                |
| ------ | ------------ | ------------------------------------------------------- | ----------------------------------------------------- | ------------------- |
| 接口功能验证 | 测试添加商品到购物车   | HTTP POST 请求，参数：userId=2025、bookId=1001、quantity=2      | 1. 响应状态码 200；2. 返回 “添加成功” 提示；3. cart_items 表新增对应记录    | 验证购物车添加接口逻辑         |
| 接口功能验证 | 测试获取购物车信息    | HTTP GET 请求，参数：userId=2025                              | 1. 响应状态码 200；2. 返回购物项列表（含图书信息、数量、单价）；3. 包含购物车总价       | 验证购物车查询接口数据组装       |
| 接口功能验证 | 测试清空购物车      | HTTP POST 请求，参数：userId=2025                             | 1. 响应状态码 200；2. 返回 “清空成功” 提示；3. cart_items 表中该用户记录被删除 | 验证购物车清空接口与 DAO 层联动  |
| 状态校验   | 测试未登录状态访问购物车 | HTTP GET 请求，无 userId（未登录）                               | 1. 响应状态码 302；2. 重定向至登录页；3. 不返回购物车数据                   | 验证 Controller 层身份校验 |
| 数据验证   | 测试无效图书 ID 添加 | HTTP POST 请求，参数：userId=2025、bookId=9999（不存在）、quantity=1 | 1. 响应状态码 404；2. 返回 “图书不存在” 提示；3. 不执行购物项添加             | 验证图书 ID 有效性校验       |
| 边缘场景   | 测试空购物车 ID 清空 | HTTP POST 请求，参数：userId=""                               | 1. 响应状态码 400；2. 返回 “用户 ID 不能为空” 提示；3. 不执行清空操作         | 验证空参数容错处理           |

### （三）订单控制器（TestOrderControllerFlow/TestOrderControllerDataValidation/TestOrderControllerEdgeCases）

| 用例类别   | 用例场景         | 输入请求                              | 预期结果                                                         | 设计目的          |
| ------ | ------------ | --------------------------------- | ------------------------------------------------------------ | ------------- |
| 业务流程验证 | 测试创建订单       | HTTP POST 请求，参数：userId=2025       | 1. 响应状态码 200；2. 返回订单 ID；3. 数据库 orders 表新增记录、购物车清空、库存扣减       | 验证订单创建接口全链路   |
| 业务流程验证 | 测试获取我的订单     | HTTP GET 请求，参数：userId=2025        | 1. 响应状态码 200；2. 返回该用户的所有订单（含订单状态、金额、时间）；3. 无其他用户订单           | 验证订单查询权限控制    |
| 业务流程验证 | 测试收货         | HTTP POST 请求，参数：orderId=5001      | 1. 响应状态码 200；2. 返回 “收货成功” 提示；3. orders 表中该订单 status 变为 “已收货” | 验证订单状态更新接口    |
| 数据验证   | 测试无效订单 ID 发货 | HTTP POST 请求，参数：orderId=9999（不存在） | 1. 响应状态码 404；2. 返回 “订单不存在” 提示；3. 不更新订单状态                     | 验证订单 ID 有效性校验 |
| 边缘场景   | 测试空购物车结账     | HTTP POST 请求，userId=2025（购物车为空）   | 1. 捕获 “空指针” panic；2. 响应状态码 500；3. 返回 “购物车无商品，无法创建订单” 提示      | 验证异常场景下的错误捕获  |
| 边缘场景   | 测试空订单 ID 收货  | HTTP POST 请求，参数：orderId=""        | 1. 响应状态码 400；2. 返回 “订单 ID 不能为空” 提示；3. 不执行收货操作                | 验证空参数容错处理     |

### （四）用户控制器（TestLoginFlowHTTP/TestSessionManagement/TestUserControllerEdgeCases）

| 用例类别       | 用例场景             | 输入请求                                                         | 预期结果                                               | 设计目的               |
| ---------- | ---------------- | ------------------------------------------------------------ | -------------------------------------------------- | ------------------ |
| 登录流程验证     | 测试登录成功           | HTTP POST 请求，表单数据：username=“testuser123”、password=“123456a!” | 1. 响应状态码 302；2. 重定向至主页；3. 设置 Session Cookie        | 验证登录接口与 Session 创建 |
| 登录流程验证     | 测试注销功能           | HTTP GET 请求，携带已登录 Session Cookie                             | 1. 响应状态码 302；2. 重定向至登录页；3. 删除 Session Cookie       | 验证注销接口与 Session 删除 |
| 登录流程验证     | 测试重复登录           | 已登录用户再次提交登录请求（同用户名密码）                                        | 1. 响应状态码 302；2. 重定向至主页；3. 刷新 Session 有效期           | 验证重复登录处理逻辑         |
| Session 管理 | 测试 Session 创建和验证 | 登录成功后，访问需授权接口（如 /getMyOrder）                                 | 1. 响应状态码 200；2. 返回用户订单数据；3. 不跳转登录页                 | 验证 Session 有效性     |
| 边缘场景       | 测试无效 Cookie 注销   | HTTP GET 请求，携带无效 Session Cookie（格式错误）                        | 1. 响应状态码 302；2. 重定向至登录页；3. 提示 “登录状态无效”             | 验证无效 Session 处理    |
| 边缘场景       | 测试空表单注册          | HTTP POST 请求，表单数据全为空                                         | 1. 响应状态码 400；2. 返回 “用户名 / 密码 / 邮箱不能为空” 提示；3. 不执行注册 | 验证注册表单空值校验         |

## 四、用例设计补充说明

1. **依赖处理**：针对 “购物车 - 图书”“订单 - 购物车” 等依赖场景，用例设计时先执行前置操作（如添加图书→再添加购物项，创建购物车→再创建订单），确保依赖数据存在；
2. **环境隔离**：每个测试用例执行前初始化测试数据（如创建临时测试用户、测试图书），执行后清理数据（删除测试记录），避免用例间数据干扰；
3. **并发用例特殊处理**：使用 Go 语言`sync.WaitGroup`控制协程同步，确保并发用例中所有协程执行完成后再校验结果（如并发添加购物项后，统一查询购物车总数），避免结果判断偏差。

# 测试环境与配置

## 一、硬件环境

本次测试基于本地开发与测试一体化硬件架构，保障测试过程中无硬件性能瓶颈（如 CPU 占用过高、内存不足、磁盘 IO 延迟），具体配置如下：

| 硬件类别 | 型号 / 规格                                                                                                                                                                                       | 数量  | 用途说明                                                                                                               | 性能保障点                                                                                                                                                                                            |
| ---- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 测试主机 | CPU：Intel Core i7-12700H（14 核 20 线程，基础频率 2.3GHz，最高睿频 4.7GHz）<br><br>内存：32GB DDR5 4800MHz（双通道）<br><br>硬盘：1TB NVMe SSD（顺序读写速度≥3500MB/s、≥3000MB/s）<br><br>显卡：Intel Iris Xe Graphics（集成显卡，显存 2GB） | 2 台 | 1. 主机 1：部署 DAO 层测试环境，运行 MySQL 数据库与 DAO 层测试用例<br><br>2. 主机 2：部署 Controller 层测试环境，运行 Go 项目服务与 Controller 层 HTTP 接口测试 | 1. 多核 CPU 支持高并发测试场景（如 10 + 协程并发添加购物项），避免 CPU 资源不足导致测试超时<br><br>2. 大内存保障数据库与测试服务同时运行时无内存溢出，尤其支持批量数据查询（如分页查询 1000 + 条图书数据）<br><br>3. 高速 NVMe SSD 降低数据库 IO 延迟，避免磁盘读写慢导致的测试结果偏差（如库存扣减、订单创建等数据库密集型操作） |
| 网络设备 | 路由器：TP-Link AX3000（支持 Wi-Fi 6，无线速率 3000Mbps）<br><br>网线：CAT6 类千兆网线（传输速率 1000Mbps）                                                                                                              | 1 套 | 1. 测试主机间局域网连接（主机 1 与主机 2 通过网线直连）<br><br>2. 测试主机与本地数据库的网络通信                                                         | 1. 千兆网络带宽保障测试过程中无网络丢包、延迟（延迟＜1ms），避免因网络问题导致 “数据库连接超时”“接口请求失败” 等误报<br><br>2. 局域网环境隔离外部网络干扰，确保测试结果稳定性（如并发查询图书时无外部网络波动影响）                                                                            |
| 辅助设备 | 显示器：Dell U2419H（23.8 英寸，1080P 分辨率，60Hz 刷新率）<br><br>键盘鼠标：机械键盘 + 无线鼠标                                                                                                                           | 2 套 | 测试人员操作测试主机，查看测试日志、调试测试用例                                                                                           | 高清显示器与舒适输入设备提升测试操作效率，便于实时监控测试过程（如查看 Go test -v 输出的详细用例执行日志）                                                                                                                                      |

## 二、软件环境

软件环境严格遵循 “开发 - 测试环境一致性” 原则，确保测试结果与生产环境预期行为一致，同时配置必要的测试工具与依赖，具体如下：

### （一）基础操作系统

| 软件名称                               | 版本                   | 安装主机                 | 配置说明                                                                                                                | 用途                                                                            |
| ---------------------------------- | -------------------- | -------------------- | ------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| Windows 11 专业版                     | 22H2（操作系统版本 25398.1） | 所有测试主机               | 1. 关闭 Windows Defender 实时防护（避免拦截测试进程）<br><br>2. 禁用休眠、屏保（防止测试过程中主机休眠导致测试中断）<br><br>3. 调整电源计划为 “高性能”（保障 CPU、内存性能稳定输出） | 提供测试用例执行、项目部署、数据库运行的基础操作系统环境，兼容 Go 语言开发工具与 MySQL 数据库                          |
| WSL 2（Windows Subsystem for Linux） | Ubuntu 22.04 LTS     | 主机 2（Controller 层测试） | 1. 分配 2 核 CPU、8GB 内存<br><br>2. 安装 Docker Desktop（用于模拟 Linux 环境下的接口测试）                                               | 辅助测试 Controller 层跨系统兼容性（如 Linux 环境下的 HTTP 接口请求、Session 管理），补充 Windows 环境的测试覆盖 |

### （二）开发与测试核心软件

| 软件类别        | 软件名称            | 版本                              | 安装主机                 | 配置说明                                                                                                                                                                                                                                                                                                                                                                    | 用途                                                                                                                                                           |
| ----------- | --------------- | ------------------------------- | -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 开发语言        | Go（Golang）      | 1.21.0（windows/amd64）           | 所有测试主机               | 1. 配置 GOPATH：D:\Go\GOPATH<br><br>2. 配置 GOROOT：C:\Go<br><br>3. 开启 Go Modules（GO111MODULE=on），设置代理：GOPROXY=[https://goproxy.cn](https://goproxy.cn/)                                                                                                                                                                                                                      | 1. 编译、运行项目代码（DAO 层、Controller 层业务逻辑）<br><br>2. 执行内置 testing 包进行单元测试（如 go test -v、go test -cover）                                                             |
| 数据库         | MySQL           | 8.0.32（InnoDB 存储引擎）             | 主机 1（DAO 层测试）        | 1. 配置 my.ini：<br><br>- max_connections=1000（支持高并发数据库连接，如并发创建订单时的多连接请求）<br><br>- wait_timeout=600s（延长连接超时时间，避免测试用例执行中连接断开）<br><br>- innodb_flush_log_at_trx_commit=1（确保事务 ACID 特性，避免数据一致性问题）<br><br>2. 创建数据库：bookstore（字符集 utf8mb4，排序规则 utf8mb4_general_ci）<br><br>3. 导入表结构：books（图书表）、cart_items（购物项表）、orders（订单表）、users（用户表），并配置外键约束（如 cart_items.book_id 关联 books.id） | 存储项目业务数据（图书、购物车、订单、用户），提供 DAO 层测试所需的数据库交互环境，验证数据增删改查、外键关联、事务等逻辑正确性                                                                                           |
| 数据库管理工具     | Navicat Premium | 16.0.11                         | 所有测试主机               | 1. 建立与 MySQL 的连接（连接名：bookstore_test，主机：[localhost](https://localhost/)，端口：3306）<br><br>2. 启用 “实时监控” 功能（实时查看表数据变化，如测试库存扣减后验证 books 表 stock 字段）                                                                                                                                                                                                                           | 1. 可视化管理数据库（创建表、插入测试数据、执行 SQL 查询）<br><br>2. 辅助定位测试缺陷（如 DAO 层 “购物车清空失败” 时，查看 cart_items 表数据是否真的被删除）<br><br>3. 测试前后清理测试数据（如删除测试用户、测试订单，避免数据残留影响后续测试）           |
| 集成开发环境（IDE） | GoLand          | 2023.2.1（Build #GO-232.9559.58） | 所有测试主机               | 1. 配置 Go SDK：关联本地 Go 1.21.0<br><br>2. 安装测试辅助插件：<br><br>- Go Test Explorer（可视化展示测试用例执行结果，区分 PASS/FAIL 用例）<br><br>- Database Tools and SQL（直接在 IDE 中连接 MySQL，查看表数据）<br><br>3. 配置测试运行参数：默认添加`-v`（详细日志）、`-cover`（语句覆盖率统计）                                                                                                                                                   | 1. 编写、调试测试用例（如设置断点查看 DAO 层函数的参数传递、返回值）<br><br>2. 批量执行测试用例，导出测试报告（如将 go test 结果导出为 HTML 格式）<br><br>3. 定位测试失败原因（如 Controller 层 “空购物车结账 panic” 时，通过调试查看空指针异常位置） |
| HTTP 接口测试工具 | Postman         | 10.18.8                         | 主机 2（Controller 层测试） | 1. 创建集合 “Bookstore Controller Test”，按模块分类接口（图书接口、购物车接口、订单接口、用户接口）<br><br>2. 保存测试请求（如 “添加购物车” 请求：POST http://localhost:8080/addCart，参数 userId=2025&bookId=1001&quantity=2）<br><br>3. 配置环境变量（如设置 baseUrl=[localhost:8080](https://localhost:8080/)，避免重复输入）                                                                                                                | 辅助测试 Controller 层 HTTP 接口（如手动验证 “分页查询图书”“创建订单” 接口的响应结果，补充自动化测试的覆盖），尤其用于调试失败的接口用例（如 “空用户名登录” 返回异常页面时，查看响应 HTML 内容）                                            |

### （三）项目依赖与配置

| 依赖类别    | 依赖名称 / 配置项                    | 版本 / 值 | 用途                                                                                                                                                                                                                                                                    |                                                          |
| ------- | ----------------------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------- |
| Go 项目依赖 | gin（Web 框架）                   | v1.9.1 | Controller 层接收 HTTP 请求、处理路由（如 GET /getBooks、POST /addCart）、返回响应                                                                                                                                                                                                       |                                                          |
| Go 项目依赖 | go-sql-driver/mysql（MySQL 驱动） | v1.7.1 | DA 层建立与 MySQL 的连接，执行 SQL 语句（如插入图书、查询订单）                                                                                                                                                                                                                               |                                                          |
| Go 项目依赖 | gorilla/sessions（Session 管理）  | v1.2.2 | 用户模块处理 Session 创建、存储、删除（如登录成功后创建 Session，注销后删除 Session）                                                                                                                                                                                                               |                                                          |
| 项目配置文件  | config.ini（项目配置）              | 自定义    | 1. 数据库配置：db_host=[localhost](https://localhost/)，db_port=3306，db_user=root，db_pwd=123456，db_name=bookstore<br><br>2. 服务配置：server_port=8080，session_timeout=3600（Session 有效期 1 小时）<br><br>3. 视图配置：views_dir=C:\Users\22977\Desktop\Bookstore\views（Controller 层模板文件路径） | 统一管理项目配置，确保测试环境与开发环境使用相同配置（如数据库连接参数、服务端口），避免配置不一致导致的测试异常 |

### （四）环境一致性保障措施

1. **版本锁定**：通过`go.mod`文件锁定 Go 项目依赖版本（如 gin v1.9.1、mysql driver v1.7.1），确保所有测试主机安装相同版本的依赖，避免依赖版本差异导致的功能兼容问题；

2. **环境复制**：使用 “环境备份工具”（如 Windows 系统的系统镜像、Docker 容器）复制基准测试环境，新测试主机直接使用备份环境，避免手动配置导致的遗漏（如 MySQL 外键约束未配置）；

3. **测试前检查**：执行测试用例前，运行 “环境检查脚本”（如检查 Go 版本、MySQL 连接、项目依赖是否安装），若检查不通过则终止测试并提示修复，确保测试环境符合要求。# 测试环境与配置）
   
   ## 一、硬件环境
   
   本次测试基于本地开发与测试一体化硬件架构，保障测试过程中无硬件性能瓶颈（如 CPU 占用过高、内存不足、磁盘 IO 延迟），具体配置如下：
   
   | 硬件类别 | 型号 / 规格                                                                                                                                                                                       | 数量  | 用途说明                                                                                                               | 性能保障点                                                                                                                                                                                            |
   | ---- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | 测试主机 | CPU：Intel Core i7-12700H（14 核 20 线程，基础频率 2.3GHz，最高睿频 4.7GHz）<br><br>内存：32GB DDR5 4800MHz（双通道）<br><br>硬盘：1TB NVMe SSD（顺序读写速度≥3500MB/s、≥3000MB/s）<br><br>显卡：Intel Iris Xe Graphics（集成显卡，显存 2GB） | 2 台 | 1. 主机 1：部署 DAO 层测试环境，运行 MySQL 数据库与 DAO 层测试用例<br><br>2. 主机 2：部署 Controller 层测试环境，运行 Go 项目服务与 Controller 层 HTTP 接口测试 | 1. 多核 CPU 支持高并发测试场景（如 10 + 协程并发添加购物项），避免 CPU 资源不足导致测试超时<br><br>2. 大内存保障数据库与测试服务同时运行时无内存溢出，尤其支持批量数据查询（如分页查询 1000 + 条图书数据）<br><br>3. 高速 NVMe SSD 降低数据库 IO 延迟，避免磁盘读写慢导致的测试结果偏差（如库存扣减、订单创建等数据库密集型操作） |
   | 网络设备 | 路由器：TP-Link AX3000（支持 Wi-Fi 6，无线速率 3000Mbps）<br><br>网线：CAT6 类千兆网线（传输速率 1000Mbps）                                                                                                              | 1 套 | 1. 测试主机间局域网连接（主机 1 与主机 2 通过网线直连）<br><br>2. 测试主机与本地数据库的网络通信                                                         | 1. 千兆网络带宽保障测试过程中无网络丢包、延迟（延迟＜1ms），避免因网络问题导致 “数据库连接超时”“接口请求失败” 等误报<br><br>2. 局域网环境隔离外部网络干扰，确保测试结果稳定性（如并发查询图书时无外部网络波动影响）                                                                            |
   | 辅助设备 | 显示器：Dell U2419H（23.8 英寸，1080P 分辨率，60Hz 刷新率）<br><br>键盘鼠标：机械键盘 + 无线鼠标                                                                                                                           | 2 套 | 测试人员操作测试主机，查看测试日志、调试测试用例                                                                                           | 高清显示器与舒适输入设备提升测试操作效率，便于实时监控测试过程（如查看 Go test -v 输出的详细用例执行日志）                                                                                                                                      |
   
   ## 二、软件环境
   
   软件环境严格遵循 “开发 - 测试环境一致性” 原则，确保测试结果与生产环境预期行为一致，同时配置必要的测试工具与依赖，具体如下：
   
   ### （一）基础操作系统
   
   | 软件名称                               | 版本                   | 安装主机                 | 配置说明                                                                                                                | 用途                                                                            |
   | ---------------------------------- | -------------------- | -------------------- | ------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
   | Windows 11 专业版                     | 22H2（操作系统版本 25398.1） | 所有测试主机               | 1. 关闭 Windows Defender 实时防护（避免拦截测试进程）<br><br>2. 禁用休眠、屏保（防止测试过程中主机休眠导致测试中断）<br><br>3. 调整电源计划为 “高性能”（保障 CPU、内存性能稳定输出） | 提供测试用例执行、项目部署、数据库运行的基础操作系统环境，兼容 Go 语言开发工具与 MySQL 数据库                          |
   | WSL 2（Windows Subsystem for Linux） | Ubuntu 22.04 LTS     | 主机 2（Controller 层测试） | 1. 分配 2 核 CPU、8GB 内存<br><br>2. 安装 Docker Desktop（用于模拟 Linux 环境下的接口测试）                                               | 辅助测试 Controller 层跨系统兼容性（如 Linux 环境下的 HTTP 接口请求、Session 管理），补充 Windows 环境的测试覆盖 |
   
   ### （二）开发与测试核心软件
   
   | 软件类别        | 软件名称            | 版本                              | 安装主机                 | 配置说明                                                                                                                                                                                                                                                                                                                                                                    | 用途                                                                                                                                                           |
   | ----------- | --------------- | ------------------------------- | -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | 开发语言        | Go（Golang）      | 1.21.0（windows/amd64）           | 所有测试主机               | 1. 配置 GOPATH：D:\Go\GOPATH<br><br>2. 配置 GOROOT：C:\Go<br><br>3. 开启 Go Modules（GO111MODULE=on），设置代理：GOPROXY=[https://goproxy.cn](https://goproxy.cn/)                                                                                                                                                                                                                      | 1. 编译、运行项目代码（DAO 层、Controller 层业务逻辑）<br><br>2. 执行内置 testing 包进行单元测试（如 go test -v、go test -cover）                                                             |
   | 数据库         | MySQL           | 8.0.32（InnoDB 存储引擎）             | 主机 1（DAO 层测试）        | 1. 配置 my.ini：<br><br>- max_connections=1000（支持高并发数据库连接，如并发创建订单时的多连接请求）<br><br>- wait_timeout=600s（延长连接超时时间，避免测试用例执行中连接断开）<br><br>- innodb_flush_log_at_trx_commit=1（确保事务 ACID 特性，避免数据一致性问题）<br><br>2. 创建数据库：bookstore（字符集 utf8mb4，排序规则 utf8mb4_general_ci）<br><br>3. 导入表结构：books（图书表）、cart_items（购物项表）、orders（订单表）、users（用户表），并配置外键约束（如 cart_items.book_id 关联 books.id） | 存储项目业务数据（图书、购物车、订单、用户），提供 DAO 层测试所需的数据库交互环境，验证数据增删改查、外键关联、事务等逻辑正确性                                                                                           |
   | 数据库管理工具     | Navicat Premium | 16.0.11                         | 所有测试主机               | 1. 建立与 MySQL 的连接（连接名：bookstore_test，主机：[localhost](https://localhost/)，端口：3306）<br><br>2. 启用 “实时监控” 功能（实时查看表数据变化，如测试库存扣减后验证 books 表 stock 字段）                                                                                                                                                                                                                           | 1. 可视化管理数据库（创建表、插入测试数据、执行 SQL 查询）<br><br>2. 辅助定位测试缺陷（如 DAO 层 “购物车清空失败” 时，查看 cart_items 表数据是否真的被删除）<br><br>3. 测试前后清理测试数据（如删除测试用户、测试订单，避免数据残留影响后续测试）           |
   | 集成开发环境（IDE） | GoLand          | 2023.2.1（Build #GO-232.9559.58） | 所有测试主机               | 1. 配置 Go SDK：关联本地 Go 1.21.0<br><br>2. 安装测试辅助插件：<br><br>- Go Test Explorer（可视化展示测试用例执行结果，区分 PASS/FAIL 用例）<br><br>- Database Tools and SQL（直接在 IDE 中连接 MySQL，查看表数据）<br><br>3. 配置测试运行参数：默认添加`-v`（详细日志）、`-cover`（语句覆盖率统计）                                                                                                                                                   | 1. 编写、调试测试用例（如设置断点查看 DAO 层函数的参数传递、返回值）<br><br>2. 批量执行测试用例，导出测试报告（如将 go test 结果导出为 HTML 格式）<br><br>3. 定位测试失败原因（如 Controller 层 “空购物车结账 panic” 时，通过调试查看空指针异常位置） |
   | HTTP 接口测试工具 | Postman         | 10.18.8                         | 主机 2（Controller 层测试） | 1. 创建集合 “Bookstore Controller Test”，按模块分类接口（图书接口、购物车接口、订单接口、用户接口）<br><br>2. 保存测试请求（如 “添加购物车” 请求：POST http://localhost:8080/addCart，参数 userId=2025&bookId=1001&quantity=2）<br><br>3. 配置环境变量（如设置 baseUrl=[localhost:8080](https://localhost:8080/)，避免重复输入）                                                                                                                | 辅助测试 Controller 层 HTTP 接口（如手动验证 “分页查询图书”“创建订单” 接口的响应结果，补充自动化测试的覆盖），尤其用于调试失败的接口用例（如 “空用户名登录” 返回异常页面时，查看响应 HTML 内容）                                            |
   
   ### （三）项目依赖与配置
   
   | 依赖类别    | 依赖名称 / 配置项                    | 版本 / 值 | 用途                                                                                                                                                                                                                                                                    |                                                          |
   | ------- | ----------------------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------- |
   | Go 项目依赖 | gin（Web 框架）                   | v1.9.1 | Controller 层接收 HTTP 请求、处理路由（如 GET /getBooks、POST /addCart）、返回响应                                                                                                                                                                                                       |                                                          |
   | Go 项目依赖 | go-sql-driver/mysql（MySQL 驱动） | v1.7.1 | DA 层建立与 MySQL 的连接，执行 SQL 语句（如插入图书、查询订单）                                                                                                                                                                                                                               |                                                          |
   | Go 项目依赖 | gorilla/sessions（Session 管理）  | v1.2.2 | 用户模块处理 Session 创建、存储、删除（如登录成功后创建 Session，注销后删除 Session）                                                                                                                                                                                                               |                                                          |
   | 项目配置文件  | config.ini（项目配置）              | 自定义    | 1. 数据库配置：db_host=[localhost](https://localhost/)，db_port=3306，db_user=root，db_pwd=123456，db_name=bookstore<br><br>2. 服务配置：server_port=8080，session_timeout=3600（Session 有效期 1 小时）<br><br>3. 视图配置：views_dir=C:\Users\22977\Desktop\Bookstore\views（Controller 层模板文件路径） | 统一管理项目配置，确保测试环境与开发环境使用相同配置（如数据库连接参数、服务端口），避免配置不一致导致的测试异常 |
   
   ### （四）环境一致性保障措施
   
   1. **版本锁定**：通过`go.mod`文件锁定 Go 项目依赖版本（如 gin v1.9.1、mysql driver v1.7.1），确保所有测试主机安装相同版本的依赖，避免依赖版本差异导致的功能兼容问题；
   2. **环境复制**：使用 “环境备份工具”（如 Windows 系统的系统镜像、Docker 容器）复制基准测试环境，新测试主机直接使用备份环境，避免手动配置导致的遗漏（如 MySQL 外键约束未配置）；
   3. **测试前检查**：执行测试用例前，运行 “环境检查脚本”（如检查 Go 版本、MySQL 连接、项目依赖是否安装），若检查不通过则终止测试并提示修复，确保测试环境符合要求。