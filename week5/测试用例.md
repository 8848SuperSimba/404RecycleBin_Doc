# 测试用例

## 首部

### attributes

- **项目名称**: Go语言书城项目

- **项目标识**: GOBOOKSTORE-2025-001

- **版本**: V1.0

### 状态与版本信息

- **文件状态**: 正式报告

- **文件标识**: SC-GOBOOKSTORE-V1.0-DRAFT

- **当前版本**: V1.0

- **作者**:
  
  - **姓名**: 白雨轩
  
  - **学号**: 2022011150
  
  - **姓名**: 牛岳峰
  
  - **学号**: 2022011155
  
  - **姓名**: 殷科鹏
  
  - **学号**: 2022010263
  
  - **团队**: 404回收站

- **完成日期**: 2025年10月22

- **版本更新信息**: 首次创建

### 引言

- **使用人员**:

- **角色与职责**:

  - **项目管理人员**: 统筹整体规划，实时跟踪进度，高效协调资源，把控项目方向与节奏。

  - **测试团队**: 全方位开展系统测试，深挖潜在缺陷，严守质量关卡，确保系统零隐患上线。

  - **运维团队**: 前置规划部署方案，优化运维流程，提前布局资源，为系统平稳运行保驾护航。

  - **协同机制**: 各团队分工明晰、无缝对接，以高效沟通与紧密协作，合力驱动项目高速前行。


- **编写目的**: 
1. 为测试团队提供明确、可执行的测试依据，规范测试流程与操作标准，确保全面覆盖系统功能、性能及兼容性等关键维度，精准识别潜在缺陷。
2. 为项目管理人员提供测试进度与质量的可视化参考，助力其及时把控项目风险，合理协调资源，保障项目按计划推进。
3. 为运维团队提供系统测试后的基础信息支撑，便于其提前规划部署方案、预判运维风险，为系统上线后的稳定运行奠定基础。
- **定义与缩写**:
  - **业务术语**:
    - **书城系统**: 基于Go语言开发的在线图书商城应用系统，包含前端界面、后端服务、数据库等完整组成部分
  - **技术术语**:
    - **GO语言**: 由Google开发的开源编程语言，以其高性能、并发特性和简洁语法适用于后端服务开发
    - **单元测试**: 对最小可测模块（如 userdao_test.go）进行隔离验证，确保代码逻辑正确。  
    - **功能测试**: 从用户视角验证整个功能链是否满足需求规格
    - **敏捷开发**: 快速响应变化、持续交付价值的协作式开发模式。
    - **迭代开发**: 分周期重复“规划-实现-评审”循环，逐步完善系统。
  - **解释**: 无
## 项目
###  1.书店管理系统测试项目报告

## 一、测试项目基本信息

### 测试项目名称： **Bookstore_test（书店管理系统测试项目）**

##  二、测试时间    ：**2025年10月22日**

##  三、项目架构
```
MVC架构模式
├── Model层 - 数据模型定义
├── View层 - 前端页面
├── Controller层 - HTTP请求处理
├── DAO层 - 数据访问层
└── Utils层 - 工具类
```

---
##  四、测试人员

## 五、测试内容详细说明

#### 测试文件总览（共8个测试文件）

### （一）. 用户模块测试
**测试文件：**
- `dao/userdao_test.go` (760行，DAO层测试)
- `controller/user_controller_test.go` (Controller层测试)

**测试功能点：**
1. **用户注册测试 (TestSaveUser)**
   - 正常注册流程
   - 用户名重复验证
   - 邮箱重复验证
   - 空值处理
   - 特殊字符处理
   - 长用户名处理

2. **用户登录验证测试 (TestCheckUserNameAndPassword)**
   - 正确用户名密码验证
   - 错误密码处理
   - 不存在用户名处理
   - 空值处理
   - 大小写敏感测试
   - SQL注入防护测试

3. **登录流程测试 (TestLoginFlow)**
   - 未登录状态访问
   - 登录成功流程
   - 登录失败处理
   - 注销功能
   - Session过期处理
   - 并发登录测试

4. **HTTP登录流程测试 (TestLoginFlowHTTP)**
   - HTTP未登录访问
   - HTTP登录成功
   - HTTP登录失败
   - HTTP注销功能
   - 重复登录处理

5. **Session管理测试 (TestSessionManagement)**
   - Session创建和验证
   - Session删除
   - Session过期处理
   - 并发Session操作

### （二）. 图书管理模块测试
**测试文件：**
- `dao/book_test.go` (DAO层测试)
- `controller/book_controller_test.go` (Controller层测试)

**测试功能点：**
1. **图书CRUD操作测试 (TestBookOperations)**
   -  添加图书
   - 查询图书（全部查询、ID查询）
   - 更新图书
   - 删除图书
   - 分页功能
   - 价格范围筛选

2. **图书控制器测试 (TestBookControllerOperations)**
   - HTTP获取分页图书
   - HTTP价格筛选
   - HTTP删除图书
   - HTTP更新图书页面
   - HTTP更新或添加图书

3. **图书数据验证测试 (TestBookControllerDataValidation)**
   - 正常图书数据
   - 空标题处理
   - 空作者处理
   - 零价格/负价格处理
   - 高价格处理
   - 负库存处理

4. **图书并发操作测试**
   - 并发添加图书
   - 并发查询图书
   - 系统稳定性验证


### （三）. 购物车模块测试
**测试文件：**
- `dao/cart_test.go` (DAO层测试)
- `controller/cart_controller_test.go` (Controller层测试)

**测试功能点：**
1. **购物车CRUD操作测试 (TestCartOperations)**
   - 添加商品到购物车
   - 重复添加同一商品（数量累加）
   - 更新商品数量
   - 删除购物项
   - 清空购物车
   - 购物车总价和总数量计算

2. **购物车控制器测试 (TestCartControllerOperations)**
   - HTTP添加商品到购物车
   - HTTP重复添加同一商品
   - HTTP获取购物车信息
   - HTTP更新购物项
   - HTTP删除购物项
   - HTTP清空购物车
   - HTTP未登录状态处理

3. **购物车数据验证测试**
   - 正常图书ID
   - 空图书ID
   - 无效图书ID
   - 负图书ID

4. **购物车并发操作测试**
   - 并发添加商品
   - 并发更新购物项
   - 系统稳定性验证

### （四）. 订单管理模块测试
**测试文件：**
- `dao/order_test.go` (DAO层测试)
- `controller/order_controller_test.go` (Controller层测试)

**测试功能点：**
1. **订单流程测试 (TestOrderFlow)**
   - 创建订单
   - 订单状态更新（未发货→已发货→交易完成）
   - 库存扣减
   - 销量更新
   - 订单查询

2. **订单控制器流程测试 (TestOrderControllerFlow)**
   - 测试结账创建订单
   - 获取所有订单
   - 获取我的订单
   - 获取订单详情
   - 发货操作
   - 收货操作

3. **订单数据验证测试**
   - 正常订单
   - 零金额订单
   - 负金额订单
   - 零数量订单
   - 高金额订单
   - 已完成订单

4. **订单并发操作测试**
   - 并发创建订单（10个goroutine）
   - 并发更新订单状态（10个goroutine）
   - 并发查询订单（10个goroutine）

5. **订单性能测试 (BenchmarkOrderOperations)**
   - 创建订单性能测试
   - 获取订单性能测试
   - 获取我的订单性能测试

## 六、测试环境与系统配置

###  （一）、系统环境配置
#### 1.操作系统
- 系统版本: Windows 10 (Build 26100)
- 系统架构: 64位
- Shell环境: PowerShell

#### 2.开发语言与版本
- 语言: Go (Golang)
- Go版本: 1.25.2
- 项目模块名: bookstore

#### 3.主要依赖包
```go
require github.com/go-sql-driver/mysql v1.9.3
require filippo.io/edwards25519 v1.1.0 // indirect
```

###  （二）、数据库配置
#### 1.数据库系统
- 数据库类型: MySQL
- 连接地址: localhost:3306
- 数据库名称: bookstore
- 用户名: root
- 密码: 123456

#### 2.数据库表结构（7张表）
1. **users（用户表）**
   - id (INT, 主键, 自增)
   - username (VARCHAR(50), 唯一)
   - password (VARCHAR(100))
   - email (VARCHAR(100), 唯一)

2. **books（图书表）**
   - id (INT, 主键, 自增)
   - title (VARCHAR(100))
   - author (VARCHAR(100))
   - price (DOUBLE(11,2))
   - sales (INT)
   - stock (INT)
   - img_path (VARCHAR(100))

3. **sessions（会话表）**
   - session_id (VARCHAR(100), 主键)
   - username (VARCHAR(100))
   - user_id (INT, 外键→users.id)

4. **carts（购物车表）**
   - id (VARCHAR(100), 主键)
   - total_count (INT)
   - total_amount (DOUBLE(11,2))
   - user_id (INT, 外键→users.id)

5. **cart_items（购物项表）**
   - id (INT, 主键, 自增)
   - count (INT)
   - amount (DOUBLE(11,2))
   - book_id (INT, 外键→books.id)
   - cart_id (VARCHAR(100), 外键→carts.id)

6. **orders（订单表）**
   - id (VARCHAR(100), 主键)
   - create_time (DATETIME)
   - total_count (INT)
   - total_amount (DOUBLE(11,2))
   - state (INT) - 0:未发货, 1:已发货, 2:交易完成
   - user_id (INT, 外键→users.id)

7. **order_items（订单项表）**
   - id (INT, 主键, 自增)
   - count (INT)
   - amount (DOUBLE(11,2))
   - title (VARCHAR(100))
   - author (VARCHAR(100))
   - price (DOUBLE(11,2))
   - img_path (VARCHAR(100))
   - order_id (VARCHAR(100), 外键→orders.id)

##  七、测试框架与工具
#### 1.测试框架
- 标准库 testing: Go内置测试框架
- httptest: HTTP测试工具
- net/http: HTTP请求模拟
- url: URL编码处理

#### 2.测试类型
- 单元测试: DAO层、Utils层测试
- 集成测试: Controller层测试
- 并发测试: 并发操作稳定性测试
- 性能测试: Benchmark性能测试

#### 3.测试运行脚本
- `run_tests.bat`: Windows批处理自动化测试脚本
- 支持12个独立测试场景
- 支持性能基准测试

###  4.测试覆盖率目标
- 单元测试覆盖率: ≥ 80%
- 集成测试覆盖率: ≥ 60%
- 关键业务流程覆盖率: 100%

###  5.测试数据管理策略
- 数据准备: 使用`setupTestUser`等函数创建测试数据
- 数据清理: 使用`cleanupTestUser`等函数清理测试数据
- 数据隔离: 每个测试使用独立的测试数据（如testUserID: 777-662范围）
- 并发安全: 使用独立的测试用户ID避免冲突

---