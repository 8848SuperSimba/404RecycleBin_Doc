
# 详细设计说明书
## 一、首页
### （一）程序系统的结构
首页作为图书商城面向普通用户的核心入口，基于Go语言`net/http`标准库构建，采用“请求路由-控制器处理-数据访问”三层架构。
前端通过静态资源（CSS、JS、图片）实现页面渲染，后端通过路由映射（如`/main`、`/getPageBooksByPrice`）将用户请求分发至对应控制器函数，再由控制器调用数据访问层（DAO）接口与数据库交互，最终将图书列表、分页信息、登录状态等数据返回至前端模板，形成完整的用户交互流程。

核心数据流向为：用户请求（分页/筛选/加购）→ 路由匹配 → 控制器处理（参数解析、登录校验、数据查询）→ DAO层操作数据库 → 数据封装（Page对象）→ 模板渲染 → 页面响应。

### （二）单元设计说明
#### 1. 标识符
- 路由标识符：`/main`（首页入口）、`/getPageBooksByPrice`（分页+价格筛选）、`/addBook2Cart`（添加购物车）、`/checkUserName`（用户名校验）
- 控制器函数标识符：`GetPageBooksByPrice`（核心处理函数）、`AddBook2Cart`（购物车操作函数）、`IsLogin`（登录状态校验函数）
- 数据模型标识符：`model.Page`（分页数据模型）、`model.Book`（图书数据模型）、`model.Session`（用户会话模型）

#### 2. 标准表述方式
##### （1）程序描述
首页程序负责接收用户访问请求，支持图书列表分页展示、价格范围筛选、登录状态校验及购物车添加操作。
通过`GetPageBooksByPrice`函数统一处理“默认首页”“分页切换”“价格筛选”三种场景，自动适配有无价格条件的图书查询逻辑；
结合`IsLogin`函数判断用户登录状态，控制“加入购物车”按钮可用性；最终将图书数据、分页导航、登录信息封装到`model.Page`对象，渲染至`views/index.html`模板，向用户呈现完整首页界面。

##### （2）功能
| 功能模块         | 核心逻辑                                                                 | 关联接口/函数                                                                 |
|------------------|--------------------------------------------------------------------------|-----------------------------------------------------------------------------|
| 图书分页展示     | 解析`pageNo`参数（默认1），调用`dao.GetPageBooks`查询对应页图书，计算总页数/总记录数 | `GetPageBooksByPrice`（控制器）、`dao.GetPageBooks`（DAO）、`model.Page`（数据模型） |
| 价格范围筛选     | 解析`min`/`max`参数，调用`dao.GetPageBooksByPrice`查询符合条件图书，回显价格区间   | `GetPageBooksByPrice`（控制器）、`dao.GetPageBooksByPrice`（DAO）              |
| 登录状态控制     | 通过Cookie获取会话ID，调用`dao.IsLogin`校验登录状态，设置`Page.IsLogin`/`Page.Username` | `dao.IsLogin`（DAO）、`model.Session`（会话模型）                            |
| 加入购物车       | 校验登录状态，已登录则调用`dao.AddCartItem`添加购物项，未登录则提示“请先登录”     | `AddBook2Cart`（控制器）、`dao.GetCartByUserID`/`dao.AddCartItem`（DAO）       |
| 库存状态展示     | 前端模板遍历`Page.Books`，根据`Book.Stock`值渲染“加入购物车”按钮（>0）或“补货中”（=0） | `model.Book`（库存字段`Stock`）、`views/index.html`（模板条件渲染）            |

##### （3）性能
- 分页性能：每页默认展示4条图书数据（`dao.GetPageBooks`中`pageSize=4`），通过`LIMIT`语句减少数据库查询量，避免大量数据传输导致的页面加载延迟。
- 并发处理：基于`net/http`内置并发机制，每个请求通过独立Goroutine处理，支持高并发访问，无请求阻塞风险。
- 数据缓存：未登录用户首页数据无缓存，已登录用户购物车数据通过`Session`暂存，减少重复数据库查询。

##### （4）输入说明
| 输入参数         | 数据类型 | 来源          | 说明                                                                 |
|------------------|----------|---------------|----------------------------------------------------------------------|
| `pageNo`         | String   | URL参数       | 分页页码，默认值为“1”，无效值（负数/超总页数）自动跳转至第1页         |
| `min`            | String   | URL参数       | 价格筛选下限，为空时不限制下限，非数字格式提示“请输入有效的价格”       |
| `max`            | String   | URL参数       | 价格筛选上限，为空时不限制上限，非数字格式提示“请输入有效的价格”       |
| `bookId`         | String   | 请求参数（POST） | 图书ID，用于“加入购物车”操作，必填，需与数据库中`books.id`匹配         |
| `user`（Cookie） | String   | 浏览器Cookie  | 会话ID，用于校验用户登录状态，非必填，不存在则视为未登录               |

##### （5）输出说明
| 输出内容         | 数据类型         | 去向          | 说明                                                                 |
|------------------|------------------|---------------|----------------------------------------------------------------------|
| `model.Page`对象 | 结构体           | 模板渲染      | 包含图书列表（`Books`）、分页信息（`PageNo`/`TotalPageNo`）、登录状态（`IsLogin`） |
| 操作提示         | 字符串           | 页面弹窗/文本 | 如“添加成功”“请先登录”“未找到符合条件的图书”“库存不足”                 |
| 静态资源         | CSS/JS/图片      | 浏览器加载    | 从`views/static`目录读取，用于页面样式渲染和交互逻辑实现               |

##### （6）算法
- 分页计算算法：  
  1. 总记录数（`TotalRecord`）：通过`SELECT COUNT(*) FROM books`（或带价格条件）查询。  
  2. 总页数（`TotalPageNo`）：若`TotalRecord % PageSize == 0`，则`TotalPageNo = TotalRecord / PageSize`；否则`TotalPageNo = TotalRecord / PageSize + 1`。  
  3. 分页偏移量：`(PageNo - 1) * PageSize`，用于`LIMIT`语句查询当前页数据。
- 价格筛选算法：  
  1. 若`min`和`max`均为空，执行默认分页查询（`dao.GetPageBooks`）；  
  2. 若任一参数非空，执行带价格条件的查询（`WHERE price BETWEEN ? AND ?`），并将参数回显至`Page.MinPrice`/`Page.MaxPrice`。

##### （7）流程逻辑
1. **首页加载/分页切换流程**：  
   ① 用户访问`/main`或切换页码，请求携带`pageNo`参数；  
   ② `GetPageBooksByPrice`解析`pageNo`（默认1），判断是否有价格筛选参数；  
   ③ 调用对应DAO函数查询图书数据及总记录数，计算总页数；  
   ④ 校验用户登录状态，设置`Page`对象的`IsLogin`和`Username`；  
   ⑤ 渲染`views/index.html`，展示图书列表及分页导航（首页/上一页/下一页/末页）。

2. **价格筛选流程**：  
   ① 用户输入`min`/`max`并提交，请求携带价格参数；  
   ② 前端校验参数格式（非数字提示错误）；  
   ③ 后端调用`dao.GetPageBooksByPrice`查询符合条件的图书；  
   ④ 若无结果，页面显示“未找到符合条件的图书”；否则渲染筛选后的列表。

3. **加入购物车流程**：  
   ① 用户点击“加入购物车”，请求携带`bookId`；  
   ② 调用`dao.IsLogin`校验登录状态：  
      - 未登录：返回“请先登录”提示；  
      - 已登录：查询用户购物车，若存在该图书则更新数量，否则创建新购物项；  
   ③ 更新购物车总数量/总金额，返回“添加成功”提示。

##### （8）接口
| 接口类型         | 接口名称/路径          | 功能描述                                                                 | 参数说明                                                                 |
|------------------|-----------------------|--------------------------------------------------------------------------|----------------------------------------------------------------------|
| 路由接口         | `/main`               | 首页入口，映射至`GetPageBooksByPrice`函数                                 | 支持`pageNo`/`min`/`max`URL参数                                          |
| 路由接口         | `/addBook2Cart`       | 添加图书到购物车，映射至`AddBook2Cart`函数                                 | 需`bookId`请求参数，依赖`user`Cookie（会话ID）                          |
| DAO接口          | `dao.GetPageBooks`    | 查询带分页的图书数据，无价格筛选                                         | 入参：`pageNo`（String）；出参：`*model.Page`、`error`                    |
| DAO接口          | `dao.GetPageBooksByPrice` | 查询带分页和价格筛选的图书数据                                         | 入参：`pageNo`/`min`/`max`（均为String）；出参：`*model.Page`、`error`     |
| DAO接口          | `dao.IsLogin`         | 校验用户登录状态                                                         | 入参：`*http.Request`；出参：`flag`（Boolean）、`*model.Session`          |

##### （9）存储分配
- 静态资源存储：CSS、JS、图书封面图片存储于`views/static`目录，通过`http.Handle("/static/", ...)`配置静态资源路由，浏览器直接加载。  
- 数据存储：图书信息（ID、名称、作者、价格等）存储于MySQL数据库`bookstore0612`的`books`表，字段与`model.Book`结构体一一对应（如`id`对应`Book.ID`，`img_path`对应`Book.ImgPath`）。  
- 会话存储：用户登录状态通过`Session`存储于` sessions`表，`SessionID`（UUID）通过Cookie传递，关联用户ID和用户名。

##### （10）注释设计
- 路由配置注释：`main.go`中每个`http.HandleFunc`均添加功能说明，如`//去首页`“//添加图书到购物车中”。  
- 控制器函数注释：`bookhandler.go`中`GetPageBooksByPrice`函数注释包含功能描述、参数解析逻辑、数据处理流程。  
- DAO函数注释：`bookdao.go`中`GetPageBooksByPrice`注释说明SQL逻辑（价格条件、分页`LIMIT`）及返回值含义。  
- 模板注释：`views/index.html`中添加条件渲染注释，如`<!-- 库存>0显示加购按钮，否则显示补货中 -->`。

##### （11）限制条件
- 价格筛选限制：`min`不能大于`max`，否则无查询结果；非数字输入会触发前端校验错误，无法提交。  
- 分页限制：`pageNo`为负数或大于`TotalPageNo`时，自动跳转至第1页；`pageSize`固定为4（DAO层硬编码），不支持用户自定义。  
- 库存限制：`Book.Stock == 0`时，“加入购物车”按钮置灰，无法触发加购操作；加购时若库存不足（如当前库存1，请求加购2），需补充前端校验逻辑。

##### （12）测试计划
| 测试场景         | 测试用例                                                                 | 预期结果                                                                 |
|------------------|--------------------------------------------------------------------------|----------------------------------------------------------------------|
| 首页默认加载     | 访问`http://localhost:8080/main`，无任何参数                              | 加载第1页图书（4条），显示分页导航（总页数/总记录数正确），未登录状态下“加入购物车”提示登录 |
| 分页切换         | 访问`http://localhost:8080/main?pageNo=2`                                 | 加载第2页图书，分页导航当前页显示“2”，“上一页”可点击，“下一页”根据总页数判断是否可点击 |
| 价格筛选（有效） | 访问`http://localhost:8080/main?min=50&max=100`                           | 显示价格在50-100元之间的图书，筛选条件回显在页面，分页信息匹配筛选结果       |
| 价格筛选（无效） | 访问`http://localhost:8080/main?min=abc`                                   | 前端提示“请输入有效的价格”，不发起后端请求                                 |
| 加入购物车（已登录） | 登录后点击某本库存>0图书的“加入购物车”按钮                                 | 提示“添加成功”，数据库`cart_items`表新增/更新对应记录，购物车总数量增加       |
| 加入购物车（未登录） | 未登录时点击“加入购物车”按钮                                             | 提示“请先登录”，不操作数据库                                               |

##### （13）尚未解决的问题
- 前端校验缺失：价格筛选的`min`> `max`场景、加购数量超过库存场景，目前仅后端隐含处理（无结果/不更新），需补充前端实时校验。  
- 静态资源缓存：图书封面图片未设置缓存头，每次访问均重新加载，影响页面加载速度，需配置`Cache-Control`响应头。  
- 分页样式适配：当总页数过多（如100页）时，分页导航会横向溢出，需优化为“省略号”样式（如1...3 4 5...100）。


## 二、图书管理页
### （一）程序系统的结构
图书管理页面向管理员角色，基于“路由-控制器-DAO”架构实现图书的增删改查（CRUD）操作。后端通过`/getPageBooks`（分页列表）、`/deleteBook`（删除）、`/toUpdateBookPage`（跳转编辑页）、`/updateOraddBook`（新增/编辑）等路由，将管理员请求分发至对应控制器函数；控制器调用DAO层接口操作`books`表，实现数据持久化；前端通过`views/pages/manager/book_manager.html`（列表页）和`book_edit.html`（编辑页）实现管理界面渲染，仅允许管理员访问（依赖会话权限判断）。

核心数据流向为：管理员操作（分页/删除/编辑/新增）→ 路由匹配 → 控制器处理（参数解析、权限隐含校验）→ DAO层操作数据库 → 页面刷新/跳转 → 展示更新后的图书列表。

### （二）单元设计说明
#### 1. 标识符
- 路由标识符：`/getPageBooks`（管理页列表）、`/deleteBook`（删除图书）、`/toUpdateBookPage`（跳转编辑页）、`/updateOraddBook`（新增/编辑提交）
- 控制器函数标识符：`GetPageBooks`（列表处理）、`DeleteBook`（删除处理）、`ToUpdateBookPage`（跳转编辑页）、`UpdateOrAddBook`（新增/编辑处理）
- 数据模型标识符：`model.Page`（分页数据模型）、`model.Book`（图书数据模型）

#### 2. 标准表述方式
##### （1）程序描述
图书管理页程序为管理员提供图书全生命周期管理功能，支持分页查看图书列表、单本删除图书、编辑已有图书信息、新增图书。通过`GetPageBooks`函数加载分页图书列表，默认每页4条数据；`DeleteBook`函数实现图书删除（含确认弹窗），删除后自动刷新当前页；`ToUpdateBookPage`函数根据是否携带`bookId`，跳转至“编辑页”（预填数据）或“新增页”（空表单）；`UpdateOrAddBook`函数统一处理新增/编辑提交，根据`bookId`是否大于0判断操作类型，最终更新数据库并返回列表页。

##### （2）功能
| 功能模块         | 核心逻辑                                                                 | 关联接口/函数                                                                 |
|------------------|--------------------------------------------------------------------------|-----------------------------------------------------------------------------|
| 图书分页列表     | 解析`pageNo`参数（默认1），调用`dao.GetPageBooks`查询对应页图书，渲染管理列表 | `GetPageBooks`（控制器）、`dao.GetPageBooks`（DAO）、`book_manager.html`（模板） |
| 图书删除         | 接收`bookId`参数，调用`dao.DeleteBook`删除数据库记录，刷新当前页列表       | `DeleteBook`（控制器）、`dao.DeleteBook`（DAO）                              |
| 图书编辑跳转     | 接收`bookId`参数，调用`dao.GetBookByID`查询图书详情，跳转至`book_edit.html`预填表单 | `ToUpdateBookPage`（控制器）、`dao.GetBookByID`（DAO）                        |
| 图书新增/编辑提交 | 接收表单参数（名称/作者/价格等），判断`bookId`是否大于0：<br>- 是：调用`dao.UpdateBook`更新<br>- 否：调用`dao.AddBook`新增 | `UpdateOrAddBook`（控制器）、`dao.UpdateBook`/`dao.AddBook`（DAO）            |
| 管理员权限控制   | 隐含依赖`dao.IsLogin`校验会话，仅`Session`有效且为管理员角色可访问（需补充显式权限判断） | `dao.IsLogin`（DAO）、`model.Session`（会话模型）                            |

##### （3）性能
- 分页性能：与首页一致，每页4条数据，通过`LIMIT`减少数据库查询量，适合管理员高效管理（避免大量数据加载）。  
- 数据操作性能：删除/新增/编辑操作均为单条SQL执行（`DELETE`/`INSERT`/`UPDATE`），无复杂联表，响应延迟低。  
- 并发控制：管理员操作通常为单人或少量人，无高并发场景，`net/http`的Goroutine机制可满足并发需求。

##### （4）输入说明
| 输入参数         | 数据类型 | 来源          | 说明                                                                 |
|------------------|----------|---------------|----------------------------------------------------------------------|
| `pageNo`         | String   | URL参数       | 分页页码，默认值为“1”，无效值自动跳转至第1页                             |
| `bookId`         | String   | URL参数（删除/编辑） | 图书ID，用于定位待删除/待编辑的图书，必填，需与`books.id`匹配             |
| `title`          | String   | 表单参数（新增/编辑） | 图书名称，必填，非空校验（需补充前端逻辑）                               |
| `author`         | String   | 表单参数（新增/编辑） | 图书作者，必填，非空校验（需补充前端逻辑）                               |
| `price`          | String   | 表单参数（新增/编辑） | 图书价格，必填，需为数字且保留两位小数（需补充前端校验）                   |
| `sales`          | String   | 表单参数（新增/编辑） | 图书销量，必填，需为非负整数（需补充前端校验）                             |
| `stock`          | String   | 表单参数（新增/编辑） | 图书库存，必填，需为非负整数（需补充前端校验）                             |

##### （5）输出说明
| 输出内容         | 数据类型         | 去向          | 说明                                                                 |
|------------------|------------------|---------------|----------------------------------------------------------------------|
| `model.Page`对象 | 结构体           | 列表页渲染    | 包含图书列表（`Books`）、分页信息（`PageNo`/`TotalPageNo`/`TotalRecord`） |
| `model.Book`对象 | 结构体           | 编辑页渲染    | 包含待编辑图书的所有字段（`ID`/`Title`/`Author`等），用于表单预填         |
| 操作结果         | 页面跳转/列表刷新 | 管理页        | 删除/新增/编辑后自动跳转回`book_manager.html`，展示更新后的列表           |
| 异常提示         | 页面文本         | 编辑页/列表页 | 如数据库操作失败时，列表页不刷新（保留原数据），编辑页无提示（需补充错误反馈） |

##### （6）算法
- 分页计算算法：与首页完全一致，基于`TotalRecord`和`pageSize=4`计算`TotalPageNo`，通过`(PageNo-1)*PageSize`确定`LIMIT`偏移量。  
- 新增/编辑判断算法：在`UpdateOrAddBook`函数中，通过`book.ID > 0`判断操作类型：  
  - `book.ID > 0`：编辑操作，调用`dao.UpdateBook`执行`UPDATE books SET ... WHERE id=?`；  
  - `book.ID == 0`：新增操作，调用`dao.AddBook`执行`INSERT INTO books (...) VALUES (...)`，默认封面图路径为`/static/img/default.jpg`。

##### （7）流程逻辑
1. **管理页加载/分页切换流程**：  
   ① 管理员访问`/getPageBooks`，请求携带`pageNo`参数（默认1）；  
   ② `GetPageBooks`解析`pageNo`，调用`dao.GetPageBooks`查询对应页图书及分页信息；  
   ③ 渲染`book_manager.html`，展示图书列表（含ID/名称/作者/价格/销量/库存）及分页导航、“添加图书”按钮、“删除/修改”操作列。

2. **图书删除流程**：  
   ① 管理员点击某图书的“删除”按钮，触发确认弹窗（提示“确定要删除【xxx】吗？”）；  
   ② 确认后，请求携带`bookId`调用`/deleteBook`；  
   ③ `DeleteBook`调用`dao.DeleteBook`删除数据库记录；  
   ④ 调用`GetPageBooks`刷新当前页列表：若删除后当前页无数据，自动跳转至上一页。

3. **图书编辑流程**：  
   ① 管理员点击某图书的“修改”按钮，请求携带`bookId`调用`/toUpdateBookPage`；  
   ② `ToUpdateBookPage`调用`dao.GetBookByID`查询图书详情；  
   ③ 跳转至`book_edit.html`，表单预填图书当前信息（如`title`输入框填`Book.Title`）；  
   ④ 管理员修改表单后提交，请求携带所有字段调用`/updateOraddBook`；  
   ⑤ `UpdateOrAddBook`判断`bookId > 0`，调用`dao.UpdateBook`更新数据库；  
   ⑥ 跳转回`book_manager.html`，列表显示更新后的图书信息。

4. **图书新增流程**：  
   ① 管理员点击“添加图书”按钮，请求无`bookId`调用`/toUpdateBookPage`；  
   ② `ToUpdateBookPage`判断`book.ID == 0`，跳转至`book_edit.html`，显示空表单；  
   ③ 管理员填写表单后提交，请求携带所有字段调用`/updateOraddBook`；  
   ④ `UpdateOrAddBook`判断`bookId == 0`，调用`dao.AddBook`新增数据库记录（默认封面图路径）；  
   ⑤ 跳转回`book_manager.html`，列表新增该图书记录。

##### （8）接口
| 接口类型         | 接口名称/路径          | 功能描述                                                                 | 参数说明                                                                 |
|------------------|-----------------------|--------------------------------------------------------------------------|----------------------------------------------------------------------|
| 路由接口         | `/getPageBooks`       | 管理页列表入口，映射至`GetPageBooks`函数                                 | 支持`pageNo`URL参数，默认1                                              |
| 路由接口         | `/deleteBook`         | 删除图书，映射至`DeleteBook`函数                                         | 需`bookId`URL参数（如`/deleteBook?bookId=1001`）                        |
| 路由接口         | `/toUpdateBookPage`   | 跳转编辑/新增页，映射至`ToUpdateBookPage`函数                             | 可选`bookId`URL参数（编辑时必填，新增时无）                              |
| 路由接口         | `/updateOraddBook`    | 新增/编辑提交，映射至`UpdateOrAddBook`函数                                | 需表单参数：`bookId`（隐藏域）、`title`、`author`、`price`、`sales`、`stock` |
| DAO接口          | `dao.GetBookByID`     | 根据`bookId`查询单本图书详情                                             | 入参：`bookId`（String）；出参：`*model.Book`、`error`                    |
| DAO接口          | `dao.DeleteBook`      | 根据`bookId`删除图书记录                                                 | 入参：`bookId`（String）；出参：`error`                                  |
| DAO接口          | `dao.AddBook`         | 新增图书记录                                                             | 入参：`*model.Book`；出参：`error`                                      |
| DAO接口          | `dao.UpdateBook`      | 更新图书记录                                                             | 入参：`*model.Book`；出参：`error`                                      |

##### （9）存储分配
- 管理页模板存储：`book_manager.html`（列表页）和`book_edit.html`（编辑页）存储于`views/pages/manager`目录，通过`http.Handle("/pages/", ...)`配置路由，仅管理员可访问。  
- 图书数据存储：与首页共享`books`表，新增图书时默认封面图路径`/static/img/default.jpg`，存储于`img_path`字段；编辑时可修改除`ID`外的所有字段（`title`/`author`/`price`等）。  
- 权限关联存储：管理员角色信息隐含在`Session`中（需补充显式权限字段，如`Session.Role`），目前仅通过“是否登录”判断，需后续优化为“角色校验”。

##### （10）注释设计
- 路由注释：`main.go`中`/getPageBooks`注释为“获取带分页的图书信息”，`/deleteBook`注释为“删除图书”，明确功能用途。  
- 控制器函数注释：`bookhandler.go`中`DeleteBook`注释包含“获取`bookId`→调用DAO删除→刷新列表”流程；`UpdateOrAddBook`注释区分“新增”和“编辑”逻辑。  
- DAO函数注释：`bookdao.go`中`AddBook`/`UpdateBook`/`DeleteBook`注释说明SQL语句用途及参数含义（如`AddBook`注释“向`books`表插入图书记录”）。  
- 模板注释：`book_edit.html`中表单字段添加注释，如`<!-- 图书ID，编辑时显示，新增时隐藏 -->`。

##### （11）限制条件
- 权限限制：目前仅通过“是否登录”判断访问权限，普通用户若知道路由（如`/getPageBooks`）可绕过访问，需补充显式角色校验（如`Session.Role == "admin"`）。  
- 数据格式限制：表单提交的`price`（需float64）、`sales`/`stock`（需int）未做前端校验，若输入非数字，后端`strconv.Parse`会返回默认值（0），导致数据错误。  
- 删除限制：删除图书时未关联购物车/订单数据（如某图书已在用户购物车中，删除后购物车查询会报错），需补充“关联数据检查”（如存在关联则禁止删除或提示）。

##### （12）测试计划
| 测试场景         | 测试用例                                                                 | 预期结果                                                                 |
|------------------|--------------------------------------------------------------------------|----------------------------------------------------------------------|
| 管理页加载       | 管理员登录后访问`http://localhost:8080/getPageBooks`                     | 加载第1页图书列表（4条），显示“删除/修改”按钮、“添加图书”链接，分页导航正常 |
| 分页切换         | 访问`http://localhost:8080/getPageBooks?pageNo=3`                         | 加载第3页图书，分页导航当前页为3，“上一页”跳至2，“下一页”根据总页数判断     |
| 图书删除         | 点击某图书“删除”→确认弹窗→确认                                           | 图书从列表中消失，`books`表对应记录删除；若当前页无数据，自动跳转至上一页   |
| 图书编辑         | 点击某图书“修改”→修改价格→提交                                           | 编辑页预填原数据，提交后列表显示新价格，`books`表`price`字段更新           |
| 图书新增         | 点击“添加图书”→填写表单（名称/作者/价格等）→提交                           | 列表新增该图书，`books`表新增记录，默认封面图路径正确                     |
| 权限校验（普通用户） | 普通用户访问`http://localhost:8080/getPageBooks`                         | 跳转至登录页或提示“无权限访问”（需补充功能后验证）                         |
| 表单错误输入     | 编辑图书时，`price`输入“abc”→提交                                         | 前端提示“请输入有效的价格”（需补充校验后验证）；无校验时后端`price`为0.00   |

##### （13）尚未解决的问题
- 权限漏洞：普通用户可通过直接访问路由绕过权限，需新增“角色校验中间件”，在`GetPageBooks`/`DeleteBook`等函数前校验`Session.Role`。  
- 关联数据未处理：删除图书时未检查是否存在购物车项（`cart_items`）、订单项（`order_items`），删除后会导致关联查询`book_id`不存在，需补充“级联删除”或“禁止删除”逻辑。  
- 编辑页体验：编辑时封面图无法修改（默认路径固定），需新增“图片上传”功能，支持管理员自定义封面图。  
- 错误反馈缺失：数据库操作失败（如网络中断）时，页面无任何提示（如删除失败仍显示原列表），需补充错误弹窗或文本提示。
